import{a as d}from"./authGuard-DDO8JLiG.js";import{a as m}from"./read-BRPGqXkT.js";import{A as u,a as g}from"./constants-D_jcPeRz.js";async function y(o,{title:a,body:t,tags:e,media:i}){const l=e.split(" ");console.log(l);const s=await fetch(`${u}/${o}`,{method:"PUT",headers:{"content-Type":"application/json",Authorization:`Bearer ${JSON.parse(localStorage.accessToken)}`,"X-Noroff-API-Key":g},body:JSON.stringify({title:a,body:t,tags:e.split(" "),media:{...i}})});return{data:await s.json(),response:s}}async function f(o,a){let t;try{t=await y(o,a)}catch(e){alert(`something went wrong: ${e}`)}finally{t.response.ok&&(alert("The post has been updated"),window.location.href=`${window.location.origin}`)}}d();const p=window.location.search,w=new URLSearchParams(p),n=w.get("id");n||alert("Something wrong with the ID of the post, you'll be sent back to the main page");const h=await m(n),{title:b,body:P,tags:I,media:c}=h.data,S=document.getElementById("title"),E=document.getElementById("body"),T=document.getElementById("tags"),v=document.getElementById("url"),A=document.getElementById("alt");S.value=b;E.value=P;T.value=I.join(" ");v.value=c?.url;A.value=c?.alt;const r=document.forms.editPost;r.addEventListener("submit",o=>{o.preventDefault();const a=new FormData(r),t=Object.fromEntries(a);console.log(t);const e={title:t.title,body:t.body,tags:t.tags,media:{url:t.url,alt:t.alt}};f(n,e)});
